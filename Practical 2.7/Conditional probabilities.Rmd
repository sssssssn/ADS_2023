---
title: "Conditional probabilities"
author: "sn"
date: "2024-03-26"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyr)
```

## Lie detector problem

In a big store, around 10% of employees are stealing. Everybody has to take a lie detector test that is correct in 80% of cases (and mistakes are equally likely in either direction). Everybody says that they are not a thief.
If the lie detector says that 50 people are lying, how many of them are probably thieves? Work out the answer in two ways:
1. By setting up and running a simulation 2. By using Bayes’ theorem

### 1. By setting up and running a simulation

```{r}
# I will use the `replicate` command to generate a sample but you can use another way
# I set the sample size of 50 for the sake of simplicity. But you may set your number.
cases <- replicate(n = 1000, expr = {
Staff = sample(x = c("Innocent", "Thief"), size = 1, prob = c(0.9, 0.1)) 
if(Staff == "Innocent"){
checkResult <- sample(x = c("Pass", "Fail"), size = 1, prob = c(0.8, 0.2)) 
}else{
checkResult <- sample(x = c("Pass", "Fail"), size = 1, prob = c(0.2, 0.8)) }
# Please, note that the probability of failing for an honest person and a thief
# is unequal!
Results <- c(Staff, checkResult)
return(Results)
}) %>% t() %>% as.data.frame()

# probability
pr <- sum(cases$V1 == 'Thief' & cases$V2 == 'Fail')/sum(cases$V2 == 'Fail')
print(pr)
```

## Coin toss

Somebody tosses a fair coin repeatedly, and records the sequence of outcomes (e.g. “H-T-T-T-T-H-H-T-. . .”). How long would it take until the sequence “H-T-T-H” first appears?

1. Complete the Markov chain diagram we started in the lecture
2. Using the Markov chain, create a simulation and run it many times to answer your question


```{r}
#0110
#H <- 0
#T <- 1
result <- c(0,1,1,0)
store <- c()
for(i in 1:1000){
  toss <- c()
  count <- 0
  repeat{
    current <- sample(0:1, 1, replace = TRUE, prob = c(0.5, 0.5))
    toss <- c(toss,current)
    count <- count + 1
    if(length(toss) >= 4){
      if(all(tail(toss, 4) == result) == TRUE ){
        break
      }
    }
  }
  store <- append(store, count)
}
print(sum(store)/1000)

```